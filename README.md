# rfsniffer
Целью проекта является поддержка приема сигналов от различных радиоустройств диапазона 433.92 (метеодатчики, пульты и т.п.) с помощью радиомодуля RFM69 и ядерного linux драйвера, эмулирующего lirc устройство

Для сборки требуется Docker контейнер из http://contactless.ru/wiki/index.php/%D0%9A%D0%B0%D0%BA_%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%B0%D1%82%D1%8B%D0%B2%D0%B0%D1%82%D1%8C_%D0%9F%D0%9E_%D0%B4%D0%BB%D1%8F_Wiren_Board
(если контейнере нет пакетов dh-exec и dh-autoreconf, то устанавливаем (./wbdev_additional_installs.sh)) 

Сборка исполняемых файлов:
- autoreconf -fvi  
- ./configure 
- make

В результате получается 2 нужных файла:
- wb-homa-rfsniffer-test (tests/)
- wb-homa-rfsniffer (rfsniffer/)

Необходимо скопировать wb-homa-rfsniffer и wb-homa-rfsniffer-test куда-либо на устройство

Сборка deb-пакета:
- #./build_deb.sh
Или же вручную:
- #dpkg-buildpackage -rfakeroot -us -uc (в корне проекта)

Если возникают странные ошибки полезно сделать
- #dpkg-buildpackage -T clean

При разработке не обязательно пересобирать пакет
- #make clean && make -j 8


Большинство настроек можно передавать испольняемому файлу через json config. Пример в rfsniffer/rfsniffer.json. Использование конфига делается через -c <config.json>
(в deb пакете нужный файл с настройками будет установлен автоматически)

rftest проверяет работу в целом (логирование, парсер, работу с RFM69, прием и декодирование пакетов от RFM69), создание тестового устройства для WB.

rfsniffer слушает эфир через RFM69 и 
- При приеме данных от сенсора RST создает устройство(или обновляет показания) RST_{id сенсора} с двумя контролами (температура, влажность)
- При приеме данных от сенсора Oregon (поддерживаются V2.1 и V3.0) создает устройство(или обновляет показания) oregon_rx_{тип сенсора}_{id сенсора}_{канал} 
    Поддерживаемые устройства (уверенно 1D20, вполне вероятно 1D30, F824, F8B4, EC40, C844, EC70, D874, 1994, 1984, 2914, 2D10, 5D60)
- При приеме данных от сенсора NooLite создает устройство noolite_rx_... (поддерживаются PT111, PM111, PM112)
- При приеме данных от передатчика X10 создает устройство X10 (или обновляет последнюю команду)
- При приеме данных от пультов Livolo или Raex создает устройство Remotes(или обновляет) с контролами Raex и Livolo, содержащими последнюю команды
- Работает передача команд от устройст Noolite TX 0xd61 (61, 63) из интерфейса wirenboard

При необходимости могут быть добавлены почти любые устройства, использующие для обмена OOK модуляцию на частоте 433.92Mhz. 
